<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>英打小遊戲</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Microsoft JhengHei', 'Noto Sans', 'Roboto', 'Segoe UI', 'Arial', sans-serif;
            background: url('https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=1500&q=80') no-repeat center center fixed;
            background-size: cover;
            text-align: center;
            min-height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #f4f7f8;
            position: relative;
        }
        /* 可愛雲朵與星星 */
        body::before, body::after {
            content: '';
            position: absolute;
            z-index: 0;
            opacity: 0.18;
            pointer-events: none;
        }
        body::before {
            top: 3vw; left: 4vw;
            width: 180px; height: 68px;
            background: url('https://cdn.jsdelivr.net/gh/maecy1407/cute_BG_img/cloud-1.svg') no-repeat center/contain;
        }
        body::after {
            bottom: 2vw; right: 6vw;
            width: 110px; height: 110px;
            background: url('https://cdn.jsdelivr.net/gh/maecy1407/cute_BG_img/star-1.svg') no-repeat center/contain;
        }
        .card {
            font-family: 'Microsoft JhengHei', 'Noto Sans', 'Roboto', 'Segoe UI', 'Arial', sans-serif;
            background: rgba(34,36,60,0.87);
            backdrop-filter: blur(2px);
            padding: 2.5em 3.5em;
            box-shadow: 0 5px 32px #18253b99;
            border-radius: 24px;
            margin: 0 auto;
            min-width: 340px;
            max-width: 95vw;
            border: 2px solid #a1bfff55;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .setting-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-bottom:20px;
        }
        .setting-group label {
            font-size: 1em;
            color: #d0e1ff;
            margin-right: 5px;
        }
        .setting-group select, .setting-group input[type=number] {
            font-size: 1em;
            border-radius: 5px;
            padding: 2px 12px;
            margin-right: 18px;
        }
        h1 {
            letter-spacing: 2px;
            font-size: 2.1em;
            font-weight: 700;
            color: #3568c6;
        }
        #status {
            font-size: 1.2em;
            color: #624799;
            margin-top: 8px;
            margin-bottom: 5px;
            font-weight: 700;
        }
        #word {
            font-size: 2.7em;
            letter-spacing: 4px;
            color: #3d4258;
            font-weight: bold;
            margin: 1.3em 0 0.5em;
            min-height: 1em;
            transition: color 0.2s;
        }
        input[type="text"] {
            padding: 0.6em 0.9em;
            font-size: 1.3em;
            width: 240px;
            border: 1.5px solid #b1bad2;
            border-radius: 7px;
            outline: none;
            background: #f8fafd;
            margin-top: 1em;
            font-family: inherit;
            transition: border-color 0.2s, background 0.2s;
        }
        input[type="text"]:focus {
            border-color: #497de8;
            background: #e7effc;
        }
        button {
            margin-top: 1.4em;
            padding: 0.65em 2.2em;
            font-size: 1.07em;
            background: linear-gradient(95deg, #4265d8 20%, #68b3fb 110%);
            color: #fff;
            border: none;
            border-radius: 7px;
            cursor: pointer;
            font-family: inherit;
            font-weight: 700;
            letter-spacing: 1px;
            box-shadow: 0 2px 4px #4265d866;
            transition: background 0.2s, transform 0.08s;
        }
        button:active {
            transform: scale(0.97);
        }
        button:disabled {
            background: #c1cce8;
            cursor: not-allowed;
        }
        #feedback {
            min-height: 28px;
            font-size: 1.1em;
            margin-top: 0.2em;
            font-weight: 700;
        }
        .result {
            color: #216a51;
            font-weight: bold;
            margin-top: 2em;
            font-size: 1.25em;
        }
        .fade-correct {
            animation: correctFlash 0.6s;
        }
        @keyframes correctFlash {
            0% { background: #e8ffe5; color: #25b84b; }
            60% { background: #fff; color: #216a51; }
            100% { background: none; color: inherit; }
        }
        /* 深色主題樣式 */
        body.dark-theme {
            background: linear-gradient(135deg, #232b35 0% 40%, #111a24 100%) !important;
            color: #e2e2f2;
            font-family: 'Microsoft JhengHei', 'Noto Sans', 'Roboto', 'Segoe UI', 'Arial', sans-serif;
        }
        body.dark-theme .card {
            background: #212232ee;
            box-shadow: 0 5px 32px #425d6944;
            border: 2px solid #3c4358;
            font-family: 'Microsoft JhengHei', 'Noto Sans', 'Roboto', 'Segoe UI', 'Arial', sans-serif;
        }
        body.dark-theme h1 {
            color: #b9dbff;
        }
        body.dark-theme #status, body.dark-theme #word {
            color: #e2bbf5;
        }
        body.dark-theme input[type="text"] {
            background: #24283b;
            color: #f0f0f1;
            border: 1.5px solid #535b6c;
        }
        body.dark-theme input[type="text"]:focus {
            background: #232b35;
            border-color: #6699cc;
        }
        body.dark-theme button {
            background: linear-gradient(95deg,#37577c 15%,#6da9d7 110%);
            color: #fff;
            box-shadow: 0 2px 4px #37577c82;
        }
        body.dark-theme button:disabled {
            background: #3e516d;
            color: #b0aec1;
        }
        body.dark-theme .result {
            color: #74dbb6;
        }
        /* 深色雲朵星星透明更低 */
        body.dark-theme::before, body.dark-theme::after {
            opacity: 0.10;
        }
    </style>
</head>
<body>
    <div class="card">
        <form id="settingForm" class="setting-group" onsubmit="return false;">
            <label for="themeSelect">主題：</label>
            <select id="themeSelect">
                <option value="bright">BRIGHT</option>
                <option value="dark">DARK</option>
            </select>
            <label for="roundSelect">關卡題數：</label>
            <select id="roundSelect">
                <option value="10">10</option>
                <option value="12">12</option>
                <option value="15">15</option>
            </select>
            <label for="speedSelect">題目速度：</label>
            <select id="speedSelect">
                <option value="0">不限時</option>
                <option value="3">3秒</option>
                <option value="5">5秒</option>
                <option value="8">8秒</option>
            </select>
            <label for="levelSelect">難度：</label>
            <select id="levelSelect">
                <option value="kinder">幼稚園</option>
                <option value="ele">國小</option>
                <option value="junior">國中</option>
                <option value="high">高中</option>
                <option value="univ">大學</option>
            </select>
        </form>
        <h1>英打小遊戲</h1>
        <div id="status"></div>
        <div id="word"></div>
        <input type="text" id="input" autocomplete="off" disabled />
        <div id="feedback"></div>
        <button id="startBtn">開始遊戲</button>
        <div class="result" id="result"></div>
    </div>
<script>
// ---五級詞庫---
const WORD_BANK = {
  kinder: ['cat','dog','sun','egg','boy','girl','car','run','bus','box','red','blue','book','pen','mom','dad','toy','bag','cup','ice'],
  ele: ['apple','banana','clock','green','chair','table','jump','mouse','train','water','tree','sand','star','house','moon','cake','milk','nose','bird','foot','basket','money','cloud','wave'],
  junior: ['cherry','computer','orange','rabbit','school','family','window','friend','camera','flower','river','mountain','music','puzzle','circle','square','movie','violin','street','zebra','guitar','future','engine','station'],
  high: ['elephant','notebook','pencilcase','umbrella','xylophone','forest','animal','strong','sentence','pyramid','science','physics','history','classic','exam','design','energy','planet','novel','drama','symbol','equation','biology','concept','meaning'],
  univ: ['algorithm','philosophy','psychology','quantum','complexity','analyze','hypothesis','simulate','integral','derivative','context','research','theorem','variable','genetics','literature','spectrum','function','operator','economics','society','phenomenon','influence','structure','strategy','synthesis']
};
let ROUND = 10;
let round = 0;
let totalTime = 0;
let currentWord = '';
let startTime = null;
let gameActive = false;
let speedSec = 0;
let timer = null;
let LEVEL = 'kinder';
let WORDS = WORD_BANK[LEVEL];

const statusDiv = document.getElementById('status');
const wordDiv = document.getElementById('word');
const input = document.getElementById('input');
const feedback = document.getElementById('feedback');
const resultDiv = document.getElementById('result');
const startBtn = document.getElementById('startBtn');
const themeSelect = document.getElementById('themeSelect');
const roundSelect = document.getElementById('roundSelect');
const speedSelect = document.getElementById('speedSelect');
const levelSelect = document.getElementById('levelSelect');

roundSelect.onchange = () => { ROUND = parseInt(roundSelect.value); };
speedSelect.onchange = () => { speedSec = parseInt(speedSelect.value); };
levelSelect.onchange = () => {
  LEVEL = levelSelect.value;
  WORDS = WORD_BANK[LEVEL];
}

document.getElementById('settingForm').onchange = function() {
  // 選項改變後自動重新開啟遊戲
  resetGame();
};
function resetGame() {
  round = 0;
  totalTime = 0;
  if(timer) clearTimeout(timer);
  gameActive = false;
  resultDiv.innerText = '';
  startBtn.disabled = false;
  input.value = '';
  input.disabled = true;
  statusDiv.innerText = '';
  wordDiv.innerText = '';
  feedback.innerText = '';
}
function timeoutInput() {
  feedback.style.color = '#ff8181';
  feedback.innerText = '超時沒答，直接進入下一題';
  setTimeout(() => {
    feedback.innerText = '';
    wordDiv.classList.remove('fade-correct');
    nextRound();
  }, 700);
}
function nextRound() {
    if (round >= ROUND) {
        gameActive = false;
        input.disabled = true;
        startBtn.disabled = false;
        let avg = (totalTime / ROUND).toFixed(2);
        resultDiv.innerText = `遊戲結束！平均每題用時：${avg} 秒`;
        statusDiv.innerText = '';
        wordDiv.innerText = '';
        return;
    }
    round++;
    currentWord = WORDS[Math.floor(Math.random() * WORDS.length)];
    wordDiv.innerText = currentWord;
    wordDiv.classList.remove('fade-correct');
    statusDiv.innerText = `第 ${round} / ${ROUND} 題`;
    input.value = '';
    input.disabled = false;
    feedback.innerText = '';
    input.focus();
    startTime = new Date();
    if(timer) clearTimeout(timer);
    if(speedSec>0){
      timer = setTimeout(timeoutInput, speedSec*1000);
    }
}
input.addEventListener('keydown', function(e) {
    if (!gameActive) return;
    if (e.key === 'Enter') {
        if(timer) clearTimeout(timer);
        if (input.value === currentWord) {
            let sec = (new Date() - startTime) / 1000;
            totalTime += sec;
            feedback.style.color = '#25b84b';
            feedback.innerText = `正確！用時：${sec.toFixed(2)} 秒`;
            wordDiv.classList.add('fade-correct');
            setTimeout(() => {
                feedback.innerText = '';
                wordDiv.classList.remove('fade-correct');
                nextRound();
            }, 700);
        } else {
            feedback.style.color = '#c00';
            feedback.innerText = '輸入錯誤，請再試一次！';
            if(speedSec>0){ timer = setTimeout(timeoutInput, speedSec*1000); }
        }
    }
});
startBtn.onclick = function() {
    round = 0;
    totalTime = 0;
    gameActive = true;
    resultDiv.innerText = '';
    startBtn.disabled = true;
    nextRound();
};

themeSelect.addEventListener('change', function(){
  if(this.value==='dark') {
    document.body.classList.add('dark-theme');
  } else {
    document.body.classList.remove('dark-theme');
  }
});
// 可自動根據系統暗色偏好預設套用
if(window.matchMedia('(prefers-color-scheme: dark)').matches){
  themeSelect.value = 'dark';
  document.body.classList.add('dark-theme');
}
</script>
</body>
</html>
